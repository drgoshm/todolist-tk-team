(function(t){function e(e){for(var o,i,c=e[0],s=e[1],d=e[2],l=0,f=[];l<c.length;l++)i=c[l],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);u&&u(e);while(f.length)f.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(o=!1)}o&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},a={app:0},r=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var u=s;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0d5c":function(t,e,n){},"1a1c":function(t,e,n){"use strict";var o=n("d8a2"),a=n.n(o);a.a},"32fd":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],i={name:"app"},c=i,s=(n("cf25"),n("2877")),d=Object(s["a"])(c,a,r,!1,null,null,null),u=d.exports,l=n("2f62"),f=(n("a4d3"),n("4de4"),n("7db0"),n("c740"),n("4160"),n("a434"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("2fa7"));function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(n,!0).forEach((function(e){Object(f["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b={SET_PAGE:function(t,e){window.history.pushState(null,"","/"+e),t.page=e},TASK_TOGGLE:function(t,e){(function(t){t&&(t.done=!t.done)})(t.todos.find((function(t){return t.id===e.id})))},TASK_ADD:function(t,e){t.todos.unshift(e),t.todos.length>10&&t.todos.pop()},TASK_MODIFY:function(t,e){(function(t){t&&(t.todo=e.todo)})(t.todos.find((function(t){return t.id===e.id})))},TASK_REMOVE:function(t,e){(function(e){e>-1&&(t.total--,t.todos.splice(e,1))})(t.todos.findIndex((function(t){return t.id===e})))},SET_DETAIL_TASKID:function(t,e){t.detailed=e},FB_SET_TOTAL:function(t,e){t.total=e},FB_POP_TODOS:function(t,e){t.todos.length=0,e.forEach((function(e){t.todos.push(g({id:e.id},e.data()))}))}},_={set_page:function(t,e){var n=t.commit;n("SET_PAGE",e)},task_toggle:function(t,e){var n=t.commit;n("TASK_TOGGLE",e)},task_add:function(t,e){var n=t.commit;n("TASK_ADD",e)},task_modify:function(t,e){var n=t.commit;n("TASK_MODIFY",e)},task_remove:function(t,e){var n=t.commit;n("TASK_REMOVE",e)},change_page:function(t,e){var n=t.commit;n("CHANGE_PAGE",e)},set_detailed_taskid:function(t,e){var n=t.commit;n("SET_DETAIL_TASKID",e)}},m=n("59ca"),v=n.n(m);n("e71f");v.a.initializeApp({projectId:"todo-kt-team-cda75",databaseURL:"https://todo-kt-team-cda75.firebaseio.com"});var h=v.a.firestore(),O=n("8aa5"),y=n.n(O),k=void 0,j={SET_PAGE:function(t,e){if(t.state.loaders.pageLoading=!0,k){if(1===e)return void h.collection("todos").orderBy("createdAt","desc").limit(10).get().then((function(e){t.commit("FB_POP_TODOS",e),t.state.loaders.pageLoading=!1}));if(10*(e-1)>k.size)return void t.commit("SET_PAGE",0|k.size/10+1);console.log("page: ",e,10*(e-1),k.docs[10*(e-1)]),h.collection("todos").orderBy("createdAt","desc").startAt(k.docs[10*(e-1)]).limit(10).get().then((function(e){t.commit("FB_POP_TODOS",e),t.state.loaders.pageLoading=!1}))}else h.collection("todos").orderBy("createdAt","desc").limit(100).get().then((function(n){k=n,t.commit("FB_SET_TOTAL",n.size),t.commit("SET_PAGE",e>n.size||e<1?1:e)}))},TASK_TOGGLE:function(t,e){h.collection("todos").doc(e.id).set(e)},TASK_ADD:function(t,e){e.createdAt=y.a.firestore.FieldValue.serverTimestamp(),h.collection("todos").add(e).then((function(n){e.id=n.id,console.log("Document written with ID: ",n.id),t.commit("FB_SET_TOTAL",t.state.total++),t.commit("SET_PAGE",1),k=void 0})).catch((function(t){console.error("Error adding document: ",t)}))},TASK_MODIFY:function(t,e){h.collection("todos").doc(e.id).set(e)},TASK_REMOVE:function(t,e){h.collection("todos").doc(e).delete().then((function(){console.log("Document successfully deleted!"),t.commit("FB_SET_TOTAL",t.state.total--),k=void 0})).catch((function(t){console.error("Error removing document: ",t)}))},SET_DETAIL_TASKID:function(t,e){t.state.loaders.pageLoading=!0,h.collection("todos").doc(e).get().then((function(e){e.exists?(console.log("Document data:",e.data()),t.state.detailed_task=e.data()):console.log("No such document!"),t.state.loaders.pageLoading=!1})).catch((function(e){console.error("Error removing document: ",e),t.state.loaders.pageLoading=!1}))}},T=function(t){t.subscribe((function(e){j[e.type]&&j[e.type](t,e.payload)}))};o["a"].use(l["a"]);var P=new l["a"].Store({state:{todos:[{id:1,todo:"...",done:!1},{id:2,todo:"...",done:!1},{id:3,todo:"...",done:!1}],total:3,page:1,loaders:{pageLoading:!0},detailed_taskid:void 0,detailed_task:void 0},mutations:b,actions:_,plugins:[T]}),E=n("8c4f"),w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("card",{class:{loading:t.loaders.pageLoading},scopedSlots:t._u([{key:"header",fn:function(){return[n("h2",[t._v("Задачи")]),n("button",{staticClass:"btn btn-glyph"},[n("fa-icon",{attrs:{icon:"ellipsis-h"}})],1)]},proxy:!0},{key:"body",fn:function(){return[t.creatingMode?n("task-editor",{on:{commit:t.createTask,decline:t.declineCreateTask}},[t._v("Создать")]):t._e(),n("list",{scopedSlots:t._u([{key:"item",fn:function(e){var o=e.item;return[t.editingMode&&o.id===t.editingTaskId?n("task-editor",{on:{commit:t.editTask,decline:t.declineEditTask,remove:t.onRemoveTask},model:{value:o,callback:function(t){o=t},expression:"item"}},[t._v("Сохранить")]):n("task",{on:{edit:t.onEditTask},model:{value:o,callback:function(t){o=t},expression:"item"}})]}}]),model:{value:t.todos,callback:function(e){t.todos=e},expression:"todos"}})]},proxy:!0},{key:"footer",fn:function(){return[n("pagination",{model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}),t.creatingMode?t._e():n("button",{staticClass:"btn btn-default",on:{click:t.onCreateTask}},[t._v("Добавить")])]},proxy:!0}])})],1)},S=[],D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[t._t("header")],2),n("div",{staticClass:"card-body"},[t._t("body")],2),n("div",{staticClass:"card-footer"},[t._t("footer")],2)])},x=[],A={},C=A,$=(n("ba8e"),Object(s["a"])(C,D,x,!1,null,"dafcd76e",null)),M=$.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"list"},t._l(t.$attrs.value,(function(e){return n("li",{key:e.id,staticClass:"list-item"},[t._t("item",[t._v(t._s(e.id))],{item:e})],2)})),0)},I=[],K={},G=K,F=(n("d035"),Object(s["a"])(G,L,I,!1,null,"22dd5a0c",null)),B=F.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"task",class:{"task-done":t.$attrs.value.done,"task-empty":""===t.$attrs.value.todo.trim()}},[n("a",{staticClass:"task-description",attrs:{href:"/task/"+t.$attrs.value.id}},[t._v(t._s(t.todo()))]),n("button",{staticClass:"btn btn-glyph task-edit float-right",on:{click:function(e){return t.$emit("edit",t.$attrs.value)}}},[n("fa-icon",{attrs:{icon:"pen"}})],1),n("button",{staticClass:"btn btn-glyph task-doit float-right",on:{click:function(e){return t.task_toggle(t.$attrs.value)}}},[n("fa-icon",{attrs:{icon:"check"}})],1)])},R=[];n("498a");function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(n,!0).forEach((function(e){Object(f["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Y={methods:V({},Object(l["b"])(["task_toggle"]),{todo:function(){return""===this.$attrs.value.todo.trim()?"TODO: do nothing":this.$attrs.value.todo}})},J=Y,q=(n("a347"),Object(s["a"])(J,N,R,!1,null,"17f4f0aa",null)),H=q.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"task-editor background-darken"},[n("div",{staticClass:"task-editor-textarea plaque"},[n("textarea",{domProps:{value:t.$attrs.value?t.$attrs.value.todo:""},on:{input:function(e){t.text=e.target.value}}})]),n("div",{staticClass:"task-editor-controls"},[n("button",{staticClass:"btn btn-default",on:{click:t.commit}},[t._t("default",[t._v("Сохранить")])],2),n("button",{staticClass:"btn btn-accent",on:{click:function(e){return t.$emit("decline")}}},[t._v("Отмена")]),void 0!==t.$attrs.value?n("button",{staticClass:"btn btn-glyph",on:{click:function(e){return t.$emit("remove",t.$attrs.value.id)}}},[n("fa-icon",{attrs:{icon:"times"}})],1):t._e()])])},Q=[];function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(n,!0).forEach((function(e){Object(f["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Z={data:function(){return{text:""}},methods:X({},Object(l["b"])(["task_toggle","task_modify"]),{commit:function(){this.$attrs.value?(this.$attrs.value.todo=this.text,this.$emit("commit",this.$attrs.value)):this.$emit("commit",{todo:this.text,done:!1})}})},tt=Z,et=(n("1a1c"),Object(s["a"])(tt,U,Q,!1,null,"604f2ce7",null)),nt=et.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pagination"},[n("a",{staticClass:"btn btn-glyph",class:1==t.current_page?"disabled":"",attrs:{href:"/"},on:{click:function(e){return e.preventDefault(),t.onNavigate(1)}}},[n("fa-icon",{attrs:{icon:"angle-double-left"}})],1),n("a",{staticClass:"btn btn-glyph ",class:1==t.current_page?"disabled":"",attrs:{href:"/"+t.prev_page},on:{click:function(e){return e.preventDefault(),t.onNavigate(t.prev_page)}}},[n("fa-icon",{attrs:{icon:"angle-left"}})],1),n("ul",{staticClass:"pagination-pages"},[t.current_page>3?n("li",{staticClass:"pagination-sep"},[t._v("…")]):t._e(),t._l(t.pages,(function(e){return n("li",{key:e,class:e===t.current_page?"pagination-page active":"pagination-page"},[n("a",{staticClass:"btn btn-glyph",attrs:{href:"/"+e},on:{click:function(n){return n.preventDefault(),t.onNavigate(e)}}},[t._v(t._s(e))])])})),t.max_page-t.current_page>2?n("li",{staticClass:"pagination-sep"},[t._v("…")]):t._e()],2),n("a",{staticClass:"btn btn-glyph ",class:t.current_page==t.max_page?"disabled":"",attrs:{href:"/"+t.next_page},on:{click:function(e){return e.preventDefault(),t.onNavigate(t.next_page)}}},[n("fa-icon",{attrs:{icon:"angle-right"}})],1),n("a",{staticClass:"btn btn-glyph ",class:t.current_page==t.max_page?"disabled":"",attrs:{href:"/"+t.max_page},on:{click:function(e){return e.preventDefault(),t.onNavigate(t.max_page)}}},[n("fa-icon",{attrs:{icon:"angle-double-right"}})],1)])},at=[];n("a630"),n("e25e"),n("3ca3");function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(n,!0).forEach((function(e){Object(f["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ct={computed:it({},Object(l["c"])(["total","page"]),{max_page:function(){return 0|this.total/10+1},current_page:function(){return this.page},prev_page:function(){return this.current_page>1?this.current_page-1:1},next_page:function(){return this.current_page<this.max_page?this.current_page+1:this.max_page},pages:function(){var t=this;return 1===this.max_page?[1]:this.max_page<5?Array.from(new Array(this.max_page),(function(t,e){return e+1})):this.current_page<4?[1,2,3,4,5]:this.max_page-this.current_page<4?Array.from(new Array(5),(function(e,n){return n+t.max_page-5})):Array.from(new Array(5),(function(e,n){return n+t.current_page-2}))}}),methods:it({},Object(l["b"])(["set_page"]),{onNavigate:function(t){this.set_page(t)}}),mounted:function(){var t=this.$attrs.value?parseInt(this.$attrs.value):1;this.set_page(t<1?1:t)}},st=ct,dt=(n("a394"),Object(s["a"])(st,ot,at,!1,null,"907e927a",null)),ut=dt.exports;function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(n,!0).forEach((function(e){Object(f["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var pt={data:function(){return{creatingMode:!1,editingMode:!1,editingTaskId:-1}},components:{Card:M,List:B,Pagination:ut,Task:H,TaskEditor:nt},computed:ft({},Object(l["c"])(["todos","loaders"]),{page:function(){return this.$attrs.page?this.$attrs.page:1}}),methods:ft({},Object(l["b"])(["task_add","task_modify","task_remove"]),{onCreateTask:function(){this.creatingMode=!0,window.scrollTo(0,0)},createTask:function(t){this.creatingMode=!1,this.task_add(t)},declineCreateTask:function(){this.creatingMode=!1},onEditTask:function(t){this.editingMode=!0,this.editingTaskId=t.id},editTask:function(t){this.editingMode=!1,this.task_modify(t)},declineEditTask:function(){this.editingMode=!1},onRemoveTask:function(){this.editingMode=!1,this.task_remove(this.editingTaskId)}})},gt=pt,bt=Object(s["a"])(gt,w,S,!1,null,null,null),_t=bt.exports,mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("card",{class:{loading:t.loaders.pageLoading},scopedSlots:t._u([{key:"header",fn:function(){return[n("h2",[t._v("Задача: "+t._s(t.loaders.pageLoading?"":t.detailed_task.id))]),n("button",{staticClass:"btn btn-glyph"},[n("fa-icon",{attrs:{icon:"ellipsis-h"}})],1)]},proxy:!0},{key:"body",fn:function(){return[t.editingMode?n("task-editor",{on:{commit:t.editTask,decline:t.declineEditTask,remove:t.onRemoveTask},model:{value:t.detailed_task,callback:function(e){t.detailed_task=e},expression:"detailed_task"}},[t._v("Сохранить")]):n("div",{staticClass:"task-detail"},[n("div",[t._v(t._s(t.loaders.pageLoading?"":t.detailed_task.todo))])])]},proxy:!0},{key:"footer",fn:function(){return[t.editingMode?t._e():n("button",{staticClass:"btn btn-default",on:{click:t.onEditTask}},[t._v("Изменить")])]},proxy:!0}])})],1)},vt=[];function ht(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ht(n,!0).forEach((function(e){Object(f["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ht(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var yt={data:function(){return{editingMode:!1}},components:{Card:M,TaskEditor:nt},computed:Ot({},Object(l["c"])(["detailed_task","loaders"])),methods:Ot({},Object(l["b"])(["set_detailed_taskid","task_modify","task_remove"]),{onEditTask:function(){this.editingMode=!0},editTask:function(){this.editingMode=!1,this.task_modify(this.detailed_task)},declineEditTask:function(){this.editingMode=!1},onRemoveTask:function(){this.editingMode=!1,this.task_remove(this.detailed_task.id)}}),created:function(){console.log(this.$attrs.taskid),this.set_detailed_taskid(this.$attrs.taskid)}},kt=yt,jt=(n("c9b6"),Object(s["a"])(kt,mt,vt,!1,null,null,null)),Tt=jt.exports,Pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" 404 - Page not found ")])},Et=[],wt={},St=wt,Dt=Object(s["a"])(St,Pt,Et,!1,null,null,null),xt=Dt.exports,At=[{path:"/",component:_t},{path:"/:page",component:_t,props:!0},{path:"/task/:taskid",component:Tt,props:!0},{path:"*",component:xt}];o["a"].use(E["a"]);var Ct=new E["a"]({mode:"history",routes:At}),$t=n("ecee"),Mt=n("c074"),Lt=n("ad3d");$t["c"].add(Mt["f"],Mt["g"],Mt["e"],Mt["h"],Mt["c"],Mt["a"],Mt["d"],Mt["b"]),o["a"].component("fa-icon",Lt["a"]),o["a"].config.productionTip=!1,new o["a"]({store:P,router:Ct,render:function(t){return t(u)}}).$mount("#app")},a2fd:function(t,e,n){},a347:function(t,e,n){"use strict";var o=n("0d5c"),a=n.n(o);a.a},a394:function(t,e,n){"use strict";var o=n("d26f"),a=n.n(o);a.a},ba8e:function(t,e,n){"use strict";var o=n("32fd"),a=n.n(o);a.a},c9b6:function(t,e,n){"use strict";var o=n("a2fd"),a=n.n(o);a.a},cf25:function(t,e,n){"use strict";var o=n("fea6"),a=n.n(o);a.a},d035:function(t,e,n){"use strict";var o=n("df76"),a=n.n(o);a.a},d26f:function(t,e,n){},d8a2:function(t,e,n){},df76:function(t,e,n){},fea6:function(t,e,n){}});
//# sourceMappingURL=app.f8508e6c.js.map